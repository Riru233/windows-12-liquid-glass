<template>
  <svg
    t="1760700232942"
    class="icon"
    viewBox="0 0 1024 1024"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    p-id="51444"
    width="16"
    height="16"
    style="padding: 0 10px"
    :style="direction === 'row' ? ' transform: rotate(180deg);' : ''"
  >
    <path
      d="M180.053333 662.613333a32 32 0 0 0 45.226667 0L512 375.893333l286.72 286.72a32 32 0 1 0 45.226667-45.226666l-309.333334-309.333334a32 32 0 0 0-45.226666 0l-309.333334 309.333334a32 32 0 0 0 0 45.226666z"
      p-id="51445"
      fill="#fff"
    ></path>
  </svg>
  <img
    src="/public/icons/mmcndmgr_30509.ico"
    alt=""
    style="width: 16px; height: 16px; padding: 0 7px"
  />
  <div style="font-size: 11px; padding: 0 7px">ENG</div>
  <div class="panel" @click="togglePanel">
    <svg
      t="1760700314622"
      class="icon"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      p-id="76302"
      width="18"
      height="18"
      style="padding: 0 2px 0 7px"
    >
      <path
        d="M757.12 458.666667a353.749333 353.749333 0 0 1 63.658667 88.32 32 32 0 1 1-56.96 29.141333 290.048 290.048 0 0 0-51.968-72.192 279.978667 279.978667 0 0 0-447.701334 71.381333 32 32 0 1 1-57.130666-28.885333 343.978667 343.978667 0 0 1 550.101333-87.765333z m-89.685333 130.986666c19.114667 19.072 34.816 42.538667 45.738666 67.498667a32 32 0 1 1-58.581333 25.685333 158.72 158.72 0 0 0-32.426667-47.957333 153.258667 153.258667 0 0 0-216.746666 0c-13.226667 13.226667-23.978667 29.397333-31.829334 47.36a32 32 0 1 1-58.666666-25.6 218.026667 218.026667 0 0 1 45.269333-66.986667 217.258667 217.258667 0 0 1 307.242667 0z m205.013333-236.416c21.76 21.717333 42.24 46.506667 60.117333 72.405334a32 32 0 0 1-52.693333 36.352 461.738667 461.738667 0 0 0-52.650667-63.530667c-174.08-174.08-456.32-174.08-630.442666 0-17.962667 18.005333-35.84 39.850667-52.138667 63.317333a32 32 0 0 1-52.565333-36.48c18.346667-26.453333 38.613333-51.2 59.477333-72.106666 199.082667-199.04 521.813333-199.04 720.896 0z m-315.178667 348.16a64 64 0 1 1-90.538666 90.538667 64 64 0 0 1 90.538666-90.538667z"
        p-id="76457"
        fill="#fff"
      ></path>
    </svg>
    <!-- 扬声器 -->
    <svg
      t="1760701774222"
      class="icon"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      p-id="11142"
      width="15"
      height="15"
      style="padding: 0 2px"
    >
      <path
        d="M794.752 141.44A489.770667 489.770667 0 0 1 981.333333 526.506667c0 152.170667-69.76 292.928-186.944 385.386666a42.666667 42.666667 0 0 1-52.864-66.986666A404.48 404.48 0 0 0 896 526.528c0-125.632-57.472-241.706667-154.176-318.165333a42.666667 42.666667 0 1 1 52.906667-66.944z m-411.690667 5.333333A106.666667 106.666667 0 0 1 576 209.493333v598.912a106.666667 106.666667 0 0 1-189.952 66.645334l-107.050667-133.824H170.666667a128 128 0 0 1-127.914667-123.2L42.666667 613.226667v-192a128 128 0 0 1 128-128h105.856z m98.816 45.482667a21.333333 21.333333 0 0 0-29.802666 4.693333L339.2 352.213333a64 64 0 0 1-51.776 26.346667H170.666667a42.666667 42.666667 0 0 0-42.666667 42.666667v192a42.666667 42.666667 0 0 0 42.666667 42.666666h118.570666a64 64 0 0 1 49.984 24.021334l113.450667 141.824A21.333333 21.333333 0 0 0 490.666667 808.405333V209.493333a21.333333 21.333333 0 0 0-8.789334-17.237333z m231.125334 113.365333A297.941333 297.941333 0 0 1 810.666667 526.528c0 85.610667-36.266667 165.504-98.581334 221.738667a42.666667 42.666667 0 0 1-57.173333-63.338667A212.650667 212.650667 0 0 0 725.333333 526.528c0-60.906667-25.6-117.589333-69.76-157.802667a42.666667 42.666667 0 0 1 57.429334-63.104z"
        fill="#fff"
        fill-opacity=".85"
        p-id="11143"
      ></path>
    </svg>

    <svg
      t="1760700314622"
      class="icon"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      p-id="76302"
      width="20"
      height="20"
      style="padding: 0 10px 0 2px"
    >
      <path
        d="M725.333333 256a128 128 0 0 1 128 128v42.666667h42.666667a42.666667 42.666667 0 0 1 42.666667 42.666666v85.333334a42.666667 42.666667 0 0 1-42.666667 42.666666h-42.666667v42.666667a128 128 0 0 1-128 128H213.333333a128 128 0 0 1-128-128V384a128 128 0 0 1 128-128h512z m-0.085333 64H213.333333a64 64 0 0 0-63.744 57.856L149.333333 384v256a64 64 0 0 0 57.813334 63.701333L213.333333 704h511.914667a64 64 0 0 0 63.701333-57.813333l0.298667-6.186667V384a64 64 0 0 0-57.813333-63.701333l-6.186667-0.298667zM256 384h426.666667a42.666667 42.666667 0 0 1 42.368 37.674667L725.333333 426.666667v170.666666a42.666667 42.666667 0 0 1-37.674666 42.368L682.666667 640H256a42.666667 42.666667 0 0 1-42.368-37.674667L213.333333 597.333333v-170.666666a42.666667 42.666667 0 0 1 37.674667-42.368L256 384h426.666667H256z"
        p-id="18136"
        fill="#fff"
      ></path>
    </svg>
  </div>
  <div
    style="
      display: flex;

      align-items: flex-end;
      margin-right: 20px;
    "
    :style="
      direction === 'row'
        ? 'flex-direction: row;gap:10px;font-size:12px;'
        : 'flex-direction: column;font-size:11px;'
    "
  >
    <LiquidFilter
      id="panel-hover"
      :width="78"
      :height="32"
      displacementScale="42"
      :precise="1"
      :config_layer2="{
        radius: 12,
        gamma: 1,
        deadzone: 0.05,
        edge: 12,
        isInward: true,
      }"
    />
    <div style="font-weight: 500">{{ currentTime }}</div>
    <div :style="direction === 'row' ? '' : 'color: #ccc'">
      {{ direction === "row" ? currentWeek : "" }} {{ currentDate }}
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from "vue";
import LiquidFilter from "@/components/liquid_v2.vue";
const emits = defineEmits();
const togglePanel = () => {
  emits("toggle-panel");
};
const prop = defineProps({
  direction: {
    type: String,
    default: "row",
  },
});
// --- 时间逻辑 ---
const currentTime = ref("");
const currentDate = ref("");
const currentWeek = ref("");

const updateTime = () => {
  const now = new Date();

  // 1. 获取小时并判断 AM/PM
  let hours = now.getHours();
  const ampm = hours >= 12 ? "PM" : "AM";

  // 2. 转换为12小时制 (0点应显示为12)
  hours = hours % 12;
  hours = hours ? hours : 12;

  // 3. 格式化分钟 (始终保持两位)
  const minutes = String(now.getMinutes()).padStart(2, "0");

  currentTime.value = `${String(hours).padStart(2, "0")}:${minutes} ${ampm}`;

  // 格式化日期: 2026/2/9
  const year = now.getFullYear();
  const month = now.getMonth() + 1;
  const day = now.getDate();
  currentDate.value = `${month}/${day}/${year}`;

  // 格式化星期: Mon, Tue...
  const weeks = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  currentWeek.value = weeks[now.getDay()];
};

// 定时器变量
let timer = null;

onMounted(() => {
  updateTime(); // 立即执行一次
  timer = setInterval(updateTime, 1000); // 每秒更新
});

onUnmounted(() => {
  if (timer) clearInterval(timer); // 组件卸载时清理定时器
});
</script>
<style scoped>
@keyframes panel-hover {
  0% {
    transform: scaleX(1.2);
  }
  30% {
    transform: scaleX(1) scaleY(1.2);
  }
  100% {
    transform: scaleX(1) scaleY(1);
  }
}
.panel {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 32px;
  width: 78px;
  margin: 0 5px;
  border-radius: 12px;
}
.panel:hover {
  animation: panel-hover 0.3s ease-out forwards;
  backdrop-filter: url(#panel-hover);
}
</style>
